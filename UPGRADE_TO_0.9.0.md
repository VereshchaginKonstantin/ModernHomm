# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –≤–µ—Ä—Å–∏–∏ 0.9.0

## –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ –≤–µ—Ä—Å–∏–∏ 0.9.0

### 1. –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–∞ —É—Ä–æ–Ω–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å ¬±10% –∫ –±–∞–∑–æ–≤–æ–º—É —É—Ä–æ–Ω—É
- –£—Å—Ç–∞–ª–æ—Å—Ç—å —Ç–µ–ø–µ—Ä—å –≤–ª–∏—è–µ—Ç –Ω–∞ –±–∞–∑–æ–≤—ã–π —É—Ä–æ–Ω (–¥–æ -30%)
- –ú–æ—Ä–∞–ª—å –≤–ª–∏—è–µ—Ç –Ω–∞ –±–∞–∑–æ–≤—ã–π —É—Ä–æ–Ω (–¥–æ +20%)
- –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Ñ–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞ —É—Ä–æ–Ω–∞ —Å –ø–æ—à–∞–≥–æ–≤—ã–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤—Å–µ—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤

### 2. –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–∫–æ–Ω–æ–∫ —é–Ω–∏—Ç–æ–≤
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å —ç–º–æ–¥–∑–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —é–Ω–∏—Ç–∞
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –∏–≥—Ä–æ–≤–æ–º –ø–æ–ª–µ
- –î–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `/admin` –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **okarien**

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ —é–Ω–∏—Ç–æ–≤
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —é–Ω–∏—Ç–æ–≤ —Å –ø–æ–ª–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è (10 —à–∞–≥–æ–≤)
- –î–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `/admin` –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **okarien**

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker
goose -dir migrations postgres "user=postgres password=postgres host=localhost port=5434 dbname=telegram_bot sslmode=disable" up

# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
goose -dir migrations postgres "user=postgres dbname=telegram_bot sslmode=disable" up

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è Python —Å–∫—Ä–∏–ø—Ç
python3 migrate.py up
```

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞

```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker
./stop.sh
./start.sh

# –ï—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –Ω–∞–ø—Ä—è–º—É—é
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C) –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
python3 bot.py
```

## –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (username: okarien)

- `/admin` - –û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —ç–º–æ–¥–∑–∏ —é–Ω–∏—Ç–æ–≤ - –∏–∑–º–µ–Ω–∏—Ç—å –∏–∫–æ–Ω–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —é–Ω–∏—Ç–æ–≤
  - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø —é–Ω–∏—Ç–∞ - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø —é–Ω–∏—Ç–∞ —Å –ø–æ–ª–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ —é–Ω–∏—Ç–∞

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/admin`
2. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —ç–º–æ–¥–∑–∏ —é–Ω–∏—Ç–æ–≤"
3. –í—ã–±–µ—Ä–∏—Ç–µ —é–Ω–∏—Ç–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —ç–º–æ–¥–∑–∏ –≤ —á–∞—Ç

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —é–Ω–∏—Ç–∞

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/admin`
2. –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø —é–Ω–∏—Ç–∞"
3. –°–ª–µ–¥—É–π—Ç–µ –ø–æ—à–∞–≥–æ–≤—ã–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
   - –®–∞–≥ 1: –ù–∞–∑–≤–∞–Ω–∏–µ —é–Ω–∏—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ê—Ä—Ö–∏–º–∞–≥")
   - –®–∞–≥ 2: –≠–º–æ–¥–∑–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "üßô")
   - –®–∞–≥ 3: –¶–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "1500")
   - –®–∞–≥ 4: –£—Ä–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, "40")
   - –®–∞–≥ 5: –ó–∞—â–∏—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "5")
   - –®–∞–≥ 6: –î–∞–ª—å–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "3")
   - –®–∞–≥ 7: –ó–¥–æ—Ä–æ–≤—å–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "30")
   - –®–∞–≥ 8: –°–∫–æ—Ä–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "2")
   - –®–∞–≥ 9: –£–¥–∞—á–∞ 0.0-1.0 (–Ω–∞–ø—Ä–∏–º–µ—Ä, "0.15")
   - –®–∞–≥ 10: –®–∞–Ω—Å –∫—Ä–∏—Ç–∞ 0.0-1.0 (–Ω–∞–ø—Ä–∏–º–µ—Ä, "0.25")

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –Ω–æ–≤—ã–π —Ç–∏–ø —é–Ω–∏—Ç–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –º–∞–≥–∞–∑–∏–Ω–µ.

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

- `migrations/00004_add_unit_custom_icons.sql` - –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–∫–æ–Ω–æ–∫

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: `unit_custom_icons`**
- `id` - –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
- `unit_id` - –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ —Ç–∞–±–ª–∏—Ü—É units (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `custom_icon` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∏–∫–æ–Ω–∫–∞ (VARCHAR(10))
- `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` - –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

**game_engine.py:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_calculate_damage()` –¥–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ —É—Ä–æ–Ω–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `render_field()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∏–∫–æ–Ω–æ–∫

**db/models.py:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `UnitCustomIcon`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–≤—è–∑—å –≤ –º–æ–¥–µ–ª–∏ `Unit`

**bot.py:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/admin`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–º–æ–¥–∑–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏—è —é–Ω–∏—Ç–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `handle_message()` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–¥–º–∏–Ω—Å–∫–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:

```bash
goose -dir migrations postgres "your_connection_string" down
```

–≠—Ç–æ —É–¥–∞–ª–∏—Ç —Ç–∞–±–ª–∏—Ü—É `unit_custom_icons` –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
